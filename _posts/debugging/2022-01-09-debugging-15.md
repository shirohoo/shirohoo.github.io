---
layout: post
category:
    - debugging
title: 405 METHOD_NOT_ALLOWED
description: >
    HTML form íƒœê·¸ ì‚¬ìš©ì‹œ ë°œìƒí•œ ë¬¸ì œ
image: /assets/img/debugging/debugging.jpg
accent_image:
    background: url('/assets/img/debugging/debugging.jpg') center/cover
related_posts:
    -
---

* toc
{:toc}
  
<br />

# ğŸš¨ ë¬¸ì œ

---

`Spring WebFlux`ë¥¼ í•™ìŠµí•˜ë‹¤ ë§ˆì£¼ì¹œ ë¬¸ì œì´ë‹¤. 

ì—ëŸ¬ ë©”ì‹œì§€ ê·¸ëŒ€ë¡œ í•´ë‹¹ URIëŠ” GET ë°©ì‹ì˜ HTTP ë©”ì„œë“œë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.

<br />

![image](https://user-images.githubusercontent.com/71188307/148676635-fdcd9847-dc76-41f5-9919-4f05c1dea7ef.png)

<br />

```shell
Sun Jan 09 18:19:47 KST 2022
[d6491d4c-11, L:/0:0:0:0:0:0:0:1:8080 - R:/0:0:0:0:0:0:0:1:57273] There was an unexpected error (type=Method Not Allowed, status=405).
Request method 'GET' not supported
org.springframework.web.server.MethodNotAllowedException: 405 METHOD_NOT_ALLOWED "Request method 'GET' not supported"
	at org.springframework.web.reactive.result.method.RequestMappingInfoHandlerMapping.handleNoMatch(RequestMappingInfoHandlerMapping.java:181)
	Suppressed: The stacktrace has been enhanced by Reactor, refer to additional information below: 
Error has been observed at the following site(s):
	*__checkpoint â‡¢ org.springframework.boot.web.reactive.filter.OrderedHiddenHttpMethodFilter [DefaultWebFilterChain]
	*__checkpoint â‡¢ HTTP GET "/carts/items/61daa8af245e0001a2670b47" [ExceptionHandlingWebHandler]
Original Stack Trace:
		at org.springframework.web.reactive.result.method.RequestMappingInfoHandlerMapping.handleNoMatch(RequestMappingInfoHandlerMapping.java:181)
```

# ğŸš§ ì›ì¸

---

HTMLì˜ `form`íƒœê·¸ëŠ” `GET`ê³¼ `POST`ë§Œ ì§€ì›í•œë‹¤ê³  í•œë‹¤.

í—Œë°, ë‚˜ëŠ” formíƒœê·¸ì— DELETE ë©”ì„œë“œë¥¼ ì‚¬ìš©í–ˆê³ , HTMLì´ ì´ê²ƒì„ ì¸ì‹í•˜ì§€ ëª»í•´ ê²°ê³¼ì ìœ¼ë¡œ `DELETE`ê°€ ì•„ë‹Œ `GET`ìœ¼ë¡œ ìš”ì²­ì´ ë°œìƒí–ˆê³ , í•´ë‹¹ URIë¡œ ìš”ì²­ì„ ë°›ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ì‘ì„±ë¼ìˆì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ë°œìƒí•œ ë¬¸ì œë¡œ ì¶”ì¸¡ëœë‹¤.

HTMLì„ ë§Œì ¸ë³¸ì§€ ëª‡ ë‹¬ ì§€ë‚¬ë”ë‹ˆ ì•„ë¦¬ì†¡í•˜ë‹¤.

<br />

```html
<form method="delete" th:action="@{'/carts/items/'+${item.id}}">
    <input type="submit" value="Delete from Cart"/>
</form>
```

<br />

```java
@Controller
@RequiredArgsConstructor
@RequestMapping("/carts")
class CartController {
    private final CartManager cartManager;

    @GetMapping
    public Mono<Rendering> viewCart() {
        return cartManager.viewCart();
    }

    @GetMapping("/items")
    public Mono<Rendering> search(
        @RequestParam(required = false) String itemName,
        @RequestParam boolean useAnd
    ) {
        return cartManager.viewCart(itemName, useAnd);
    }

    @PostMapping("/items/{itemId}")
    public Mono<String> addToCart(@PathVariable String itemId) {
        return cartManager.addItemToCart("MyCart", itemId)
            .thenReturn("redirect:/carts");
    }

    // ë¬¸ì œ ë°œìƒ ë¶€ë¶„
    @DeleteMapping("/items/{itemId}")
    public Mono<String> deleteFromCart(@PathVariable String itemId) {
        return cartManager.deleteFromCart("MyCart", itemId)
            .thenReturn("redirect:/carts");
    }
}
```

<br />

# âœ… í•´ê²°

---

form íƒœê·¸ì˜ ë©”ì„œë“œë¥¼ POSTë¡œ ë³€ê²½í•´ì£¼ê³ , form íƒœê·¸ ì•ˆì— í•˜ê¸°ì™€ ê°™ì€ hidden input íƒœê·¸ë¥¼ ì¶”ê°€í•œë‹¤.

<br />

```html
<form method="post" th:action="@{'/carts/items/'+${item.id}}">
    <input type="hidden" name="_method" value="delete">
    <input type="submit" value="Delete from Cart"/>
</form>
```

<br />

ì¼ë°˜ì ì¸ HTMLì„ ì‚¬ìš©í•œë‹¤ë©´ ì—¬ê¸°ì„œ ëë‚  ê²ƒ ê°™ì€ë°, ë‚˜ëŠ” `íƒ€ì„ë¦¬í”„(Thymeleaf)`ì™€ `ì›¹í”ŒëŸ­ìŠ¤(WebFlux)`ë¥¼ ì‚¬ìš©í•˜ì˜€ìœ¼ë¯€ë¡œ í•˜ê¸°ì˜ ì„¤ì •ì„ ì¶”ê°€í•´ì£¼ì—ˆë‹¤.

<br />

```yaml
# file: 'application.yaml'
spring:
  webflux:
    hiddenmethod:
      filter:
        enabled: true
```

<br />
