---
layout: post
category:
  - spring
  - spring-data-jpa
title: Spring Data JPAì˜ ëª‡ê°€ì§€ ìœ ìš©í•œ ì •ë³´
description: |
  ê³µì‹ë¬¸ì„œ íŒŒí—¤ì¹˜ê¸°
image: /assets/img/spring/spring-data-jpa/hibernate.jpg
related_posts:
  - _posts/spring/spring-data-jpa/2021-06-23-simple-repository.md
published: true
---

* toc 
{:toc}

<br />

# ğŸ‘ Spring Data JPA

---

`Spring Data JPA`ë¥¼ ì‚¬ìš©í•˜ë©´ `Spring Data í”„ë¡œì íŠ¸`ì—ì„œ ì œê³µí•˜ëŠ” ì—¬ëŸ¬ê°€ì§€ ìœ ìš©í•œ ì¶”ìƒí™”ëœ APIë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<u>íŠ¹íˆ ì¿¼ë¦¬ ë©”ì„œë“œ ê¸°ëŠ¥ì´ ì•„ì£¼ ìœ ìš©í•˜ê³  ê°•ë ¥í•œë°ìš”, ì´ ì¿¼ë¦¬ ë©”ì„œë“œë¥¼ ì˜ ì‚¬ìš©í•˜ë©´ ì •ë§ ëŒ€ë¶€ë¶„ì˜ ìƒí™©ì„ ì´ê²ƒ í•˜ë‚˜ë¡œ í•´ê²°í• ìˆ˜ ìˆì„ ì •ë„ì…ë‹ˆë‹¤.</u>

ì¿¼ë¦¬ ë©”ì„œë“œë¡œ ë¶€ì¡±í•˜ë‹¤ë©´ `Example`ì´ë‚˜ `Querydsl`ë“±ì˜ ì‚¬ìš©ì„ ê³ ë ¤í•´ë³¼ ìˆ˜ ìˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤. 

<br />

ì¿¼ë¦¬ ë©”ì„œë“œëŠ” ë©”ì„œë“œì´ë¦„ì„ í†µí•´ ì—¬ëŸ¬ê°€ì§€ ì¿¼ë¦¬ë¥¼ ìƒì„±í•´ë‚´ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

ì¿¼ë¦¬ ë©”ì„œë“œë¡œ í•  ìˆ˜ ìˆëŠ” ëŒ€ë¶€ë¶„ì˜ ë¡¤(ROLE)ì„ ì •ë¦¬í•´ë‘ì—ˆìœ¼ë‹ˆ ê¶ê¸ˆí•˜ì‹œë‹¤ë©´ ì°¸ê³ í•˜ì…”ë„ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

- [ğŸ“¦ SimpleJpaRepository í•™ìŠµ í…ŒìŠ¤íŠ¸](./2021-06-23-simple-repository.md){:target="_blank"}

<br />

ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” `Spring Data JPAë¥¼` ì‚¬ìš©í•  ë•Œ ëª‡ê°€ì§€ ìœ ìš©í•œ íŒì„ ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤. 

<br />

## ğŸ’¡ ë°˜í™˜ íƒ€ì…ìœ¼ë¡œ `Page`ê°€ ì•„ë‹Œ `Slice`ë¥¼ ê³ ë ¤í•˜ê¸°

---

`Spring Data JPA` í”„ë¡œì íŠ¸ë¥¼ ì‚¬ìš©í•˜ë©´ `JpaRepository`ë‚˜ `CrudRepository`ë¥¼ `extends`í•˜ì—¬ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤.

ì´ë•Œ í˜ì´ì§•ì„ í•˜ëŠ” ê²½ìš° ë¬´ì‹¬ì½” ë°˜í™˜íƒ€ì…ì— `Page`ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ë§ì£ .

í•˜ì§€ë§Œ `Slice`ë¼ëŠ” íƒ€ì…ìœ¼ë¡œë„ ë°˜í™˜ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br />

```java
public interface ItemRepository extends JpaRepository<Item, Long> {
    Slice<Item> readAllByNameContaining(String name, Pageable pageable);

    Page<Item> findAllByNameContaining(String name, Pageable pageable);
}
```

<br />

ì‹œê·¸ë‹ˆì²˜ë¥¼ ì‚´í´ë³´ë©´ `Page`ëŠ” `Slice`ë¥¼ ìƒì†í•˜ì—¬ ëª‡ê°€ì§€ì˜ ë©”ì„œë“œë¥¼ ë” í™•ì¥í•œ ì¸í„°í˜ì´ìŠ¤ì…ë‹ˆë‹¤.

<br />

```java
public interface Page<T> extends Slice<T> {
    int getTotalPages();
    
    long getTotalElements();
}
```

<br />

ë‘ ë°˜í™˜ íƒ€ì…ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ëª…í™•í•œ ì°¨ì´ê°€ ìˆìŠµë‹ˆë‹¤.

<br />

- `Page`: ì¹´ìš´íŠ¸ ì¿¼ë¦¬ë¥¼ ë§¤ë²ˆ ë°œìƒì‹œí‚µë‹ˆë‹¤. 
  - ë‹¨, ì¿¼ë¦¬ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©° ì¸ìˆ˜ë¡œ ë„˜ê¸´ `Pageable`ì˜ `size`ê°’ë³´ë‹¤ ë°˜í™˜ë˜ëŠ” ë ˆì½”ë“œì˜ ìˆ˜ê°€ ì ì€ ê²½ìš°ì—ëŠ” ì¹´ìš´íŠ¸ ì¿¼ë¦¬ê°€ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. 
  - ì´ ê¸°ëŠ¥ì€ ì¿¼ë¦¬í•œ í˜ì´ì§€ì˜ ì¶”ê°€ì ì¸ ìƒì„¸í•œ ì •ë³´ë“¤ì„ í¬í•¨í•©ë‹ˆë‹¤.

- `Slice`: ì¹´ìš´íŠ¸ ì¿¼ë¦¬ë¥¼ ì•„ì˜ˆ ë°œìƒì‹œí‚¤ì§€ ì•ŠìŠµë‹ˆë‹¤.
  - ì¹´ìš´íŠ¸ ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ë‹¤ìŒ í˜ì´ì§€ê°€ ìˆìŒì„ ì•Œ ìˆ˜ ìˆëŠ” ì›ë¦¬ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. 
  - ì¿¼ë¦¬ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©° ì¸ìˆ˜ë¡œ ë„˜ê¸´ `Pageable`ì˜ `size`ê°’ë³´ë‹¤ +1ë§Œí¼ ë” ì¶”ê°€ë¡œ ì¡°íšŒí•˜ì—¬ ì¶”ê°€ë¡œ ë°˜í™˜ë˜ëŠ” ë ˆì½”ë“œê°€ ìˆëŠ” ê²½ìš°ì— ë‹¤ìŒ í˜ì´ì§€ê°€ ìˆìŒì„ íŒë‹¨í•©ë‹ˆë‹¤.

<br />

ì¦‰, í…Œì´ë¸”ì˜ ë ˆì½”ë“œê°€ ì¶©ë¶„íˆ ë§ë‹¤ë©´ ë°˜í™˜íƒ€ì…ìœ¼ë¡œ `Page`ë¥¼ ì„ ì–¸í–ˆì„ ê²½ìš° ë§¤ë²ˆ ë°œìƒí•˜ëŠ” `ì¹´ìš´íŠ¸ ì¿¼ë¦¬`ê°€ ë¶€ë‹´ì´ ë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—, ì´ ê²½ìš°ì—ëŠ” `Slice`ë¡œì˜ ë°˜í™˜ì„ ê³ ë ¤í•˜ëŠ”ê²Œ ì¢‹ìŠµë‹ˆë‹¤.

`Page`ëŠ” `Slice`ì™€ ë‹¤ë¥´ê²Œ ê°€ì ¸ì˜¨ í˜ì´ì§€ì˜ ëª¨ë“  ìƒì„¸í•œ ì •ë³´ë“¤ì„ í¬í•¨í•˜ë¯€ë¡œ ì„œë¡œê°„ì˜ `trade-off`ê°€ ë¶„ëª…íˆ ì¡´ì¬í•©ë‹ˆë‹¤.

<br />

ë‘ ë°˜í™˜íƒ€ì…ì˜ ì°¨ì´ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.

<br />

```java
@DataJpaTest
class ItemRepositoryTest {
    @Autowired
    ItemRepository itemRepository;

    @BeforeEach
    void setUp() {
        List<Item> items = new ArrayList<>();
        for (int i = 1; i <= 50; i++) {
            items.add(createItem(i));
        }
        itemRepository.saveAll(items);
    }

    // Returned Page<Item>
    @Test
    void findAllByNameContaining() throws Exception {
        itemRepository.findAllByNameContaining("1", PageRequest.of(1, 3))
                .forEach(System.out::println);
    }

    // Returned Slice<Item>
    @Test
    void readAllByNameContaining() throws Exception {
        itemRepository.readAllByNameContaining("1", PageRequest.of(1, 3))
                .forEach(System.out::println);
    }

    private Item createItem(int itemName) {
        return Item.builder()
                .name("item" + itemName)
                .description("item description")
                .createdAt(LocalDateTime.now())
                .build();
    }
}
```

<br />

`itemName`ì´ item1 ~ item50 ì¸ ì•„ì´í…œ 50ê°œë¥¼ ì €ì¥í•œ í›„ `itemName`ì— ë¬¸ìì—´ 1ì´ í¬í•¨ëœ ì•„ì´í…œë“¤ì„ ì¿¼ë¦¬í•˜ê³ , 3ê°œ ë¬¶ìŒìœ¼ë¡œ ë¶„í• í•œ í›„ ê·¸ ì¤‘ 1í˜ì´ì§€ë¥¼ ê°€ì ¸ì˜¤ë„ë¡ í•˜ëŠ” ì¿¼ë¦¬ì…ë‹ˆë‹¤.

1ë¶€í„° 50 ì‚¬ì´ì— ë¬¸ìì—´ 1ì´ í¬í•¨ëœ ìˆ˜ëŠ” ë¶„ëª…íˆ 4ê°œ ì´ìƒì´ë¯€ë¡œ ìœ„ ì„¤ëª…ëŒ€ë¡œë¼ë©´ `findAllByNameContaining`ëŠ” ì¹´ìš´íŠ¸ ì¿¼ë¦¬ê°€ ë°œìƒí•  ê²ƒì´ë©°, `readAllByNameContaining`ëŠ” ì¹´ìš´íŠ¸ ì¿¼ë¦¬ê°€ ë°œìƒí•˜ì§€ ì•Šì„ ê²ƒì…ë‹ˆë‹¤.

<br />

- **findAllByNameContaining ê²°ê³¼ (ì¹´ìš´íŠ¸ ì¿¼ë¦¬ ë°œìƒ)**

<br />

```shell
Hibernate: 
    select
        item0_.id as id1_4_,
        item0_.created_at as created_2_4_,
        item0_.description as descript3_4_,
        item0_.name as name4_4_ 
    from
        item item0_ 
    where
        item0_.name like ? escape ? limit ? offset ?
Hibernate: 
    select // ì¹´ìš´íŠ¸ ì¿¼ë¦¬ ë°œìƒ
        count(item0_.id) as col_0_0_ 
    from
        item item0_ 
    where
        item0_.name like ? escape ?
        
Item(id=12, name=item12, description=item description, createdAt=2022-01-11T19:06:25.863552900)
Item(id=13, name=item13, description=item description, createdAt=2022-01-11T19:06:25.863552900)
Item(id=14, name=item14, description=item description, createdAt=2022-01-11T19:06:25.863552900)
```

<br />

- **readAllByNameContaining ê²°ê³¼ (ì¹´ìš´íŠ¸ ì¿¼ë¦¬ ë°œìƒí•˜ì§€ ì•ŠìŒ)**

<br />

```shell
Hibernate: 
    select
        item0_.id as id1_4_,
        item0_.created_at as created_2_4_,
        item0_.description as descript3_4_,
        item0_.name as name4_4_ 
    from
        item item0_ 
    where
        item0_.name like ? escape ? limit ? offset ?
        
Item(id=12, name=item12, description=item description, createdAt=2022-01-11T19:10:14.159593600)
Item(id=13, name=item13, description=item description, createdAt=2022-01-11T19:10:14.159593600)
Item(id=14, name=item14, description=item description, createdAt=2022-01-11T19:10:14.159593600)
```

<br />

> [ğŸ“œ Spring Data JPA Docs](https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.special-parameters){:target="_blank"}
> 
> The first method lets you pass an org.springframework.data.domain.Pageable instance to the query method to dynamically add paging to your statically defined query. A Page knows about the total number of elements and pages available. It does so 
> by the infrastructure triggering a count query to calculate the overall number. As this might be expensive (depending on the store used), you can instead return a Slice. A Slice knows only about whether a next Slice is available, which might be sufficient when walking through a larger result set.

<br />

## ğŸ’¡ `ì¿¼ë¦¬ ë©”ì„œë“œ`ë¡œë„ í”„ë¡œì ì…˜ì´ ê°€ëŠ¥í•˜ë‹¤

---

`Spring Data JPA`ì˜ `ì¿¼ë¦¬ ë©”ì„œë“œ`ë¡œëŠ” í”„ë¡œì ì…˜ì´ ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— `Querydsl`ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤ëŠ” ë¶„ë“¤ì´ ê°„í˜¹ ê³„ì‹­ë‹ˆë‹¤.

[ğŸ“œ Spring Data JPAì˜ ê³µì‹ë¬¸ì„œ](https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#projections){:target="_blank"} ë¥¼ ì‚´í´ë³´ì‹œë©´ ë¶„ëª…íˆ DTO í”„ë¡œì ì…˜ì„ ì§€ì›í•˜ê³  ìˆìŒì„ ì•Œ ìˆ˜ ìˆìœ¼ë©°, í›Œë¥­í•œ DTO í”„ë¡œì ì…˜ ê¸°ëŠ¥ì— ëŒ€í•´ ë†€ë¼ì‹¤ì§€ë„ ëª¨ë¦…ë‹ˆë‹¤.

<u>ì¶”ê°€ë¡œ ì´ í¬ìŠ¤íŒ…ì—ì„œëŠ” Listë‚˜ Setë§Œì„ ì œí•œì ìœ¼ë¡œ ì‚¬ìš©í–ˆìœ¼ë‚˜, java.util.Collection ì˜ í•˜ìœ„ íƒ€ì…ì´ë‚˜ ì•Œë§ì€ ìƒì„±ìê°€ ìˆëŠ” ë‹¨ì¼ í´ë˜ìŠ¤ëŠ” ëŒ€ë¶€ë¶„ ì œí•œì—†ì´ ì‚¬ìš©ê°€ëŠ¥í•©ë‹ˆë‹¤.</u>

<br />

### ìƒì„±ì í”„ë¡œì ì…˜

---

`Item` ì—”í‹°í‹°ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í•„ë“œë¥¼ ê°–ìŠµë‹ˆë‹¤.

<br />

```java
@Entity
public class Item {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    private String name;

    private String description;

    @CreatedDate
    private LocalDateTime createdAt;
}
```

<br />

ì´ì¤‘ `name`ê³¼ `createdAt` í•„ë“œë§Œ ì™ ë½‘ì•„ì˜¤ê³  ì‹¶ë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ë‘ í•„ë“œë¥¼ í¬í•¨í•˜ëŠ” `DTO`ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.

<u>ì´ ë•Œ ì£¼ì˜í•´ì•¼ í• ê²ƒì€, ì¶”ì¶œí•˜ê³ ì í•˜ëŠ” í•„ë“œì— ëŒ€í•œ ìƒì„±ìê°€ ë°˜ë“œì‹œ ì„ ì–¸ë¼ìˆì–´ì•¼ í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.</u>

<br />

```java
@ToString
@AllArgsConstructor
public class ItemDto {
    private String name;
    private LocalDateTime createdAt;
}
```

<br />

ì´ì œ ë‹¤ìŒê³¼ ê°™ì€ ì‹œê·¸ë‹ˆì²˜ë¥¼ ê°–ëŠ” ì¶”ìƒ ë©”ì„œë“œë¥¼ ì„ ì–¸í•©ë‹ˆë‹¤.

ë°˜í™˜íƒ€ì…ì´ `Item`ì´ ì•„ë‹Œ `ItemDto`ì„ì„ ë†“ì¹˜ì§€ ë§ˆì„¸ìš”.

<br />

```java
public interface ItemRepository extends JpaRepository<Item, Long> {
    List<ItemDto> findByNameContaining(String name);
}
```

<br />

ì•„ì£¼ ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ê³  ì–´ë–¤ ê²°ê³¼ê°€ ë°œìƒí•˜ëŠ”ì§€ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

`itemName`ì— ë¬¸ìì—´ 1ì´ í¬í•¨ë¼ìˆëŠ” ì•„ì´í…œë“¤ì˜ `name`ê³¼ `createdAt`ë§Œ ì¶”ì¶œí•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.

<br />

```java
@DataJpaTest
class ItemRepositoryTest {
    @Autowired
    ItemRepository itemRepository;

    @BeforeEach
    void setUp() {
        List<Item> items = new ArrayList<>();
        for (int i = 1; i <= 50; i++) {
            items.add(createItem(i));
        }
        itemRepository.saveAll(items);
    }

    @Test
    void findByNameContaining() throws Exception {
        itemRepository.findByNameContaining("1")
                .forEach(System.out::println);
    }

    private Item createItem(int itemName) {
        return Item.builder()
                .name("item" + itemName)
                .description("item description")
                .createdAt(LocalDateTime.now())
                .build();
    }
}
```

<br />

```shell
Hibernate: 
    select
        item0_.name as col_0_0_,
        item0_.created_at as col_1_0_ 
    from
        item item0_ 
    where
        item0_.name like ? escape ?
        
ItemDto(name=item1, createdAt=2022-01-11T19:00:29.901013)
ItemDto(name=item10, createdAt=2022-01-11T19:00:29.901013)
ItemDto(name=item11, createdAt=2022-01-11T19:00:29.901013)
ItemDto(name=item12, createdAt=2022-01-11T19:00:29.901013)
ItemDto(name=item13, createdAt=2022-01-11T19:00:29.901013)
ItemDto(name=item14, createdAt=2022-01-11T19:00:29.901013)
ItemDto(name=item15, createdAt=2022-01-11T19:00:29.901013)
ItemDto(name=item16, createdAt=2022-01-11T19:00:29.901013)
ItemDto(name=item17, createdAt=2022-01-11T19:00:29.901013)
ItemDto(name=item18, createdAt=2022-01-11T19:00:29.901013)
ItemDto(name=item19, createdAt=2022-01-11T19:00:29.901013)
ItemDto(name=item21, createdAt=2022-01-11T19:00:29.901013)
ItemDto(name=item31, createdAt=2022-01-11T19:00:29.901013)
ItemDto(name=item41, createdAt=2022-01-11T19:00:29.901013)
```

<br />

í”„ë¡œì ì…˜ì´ ì•„ì£¼ ì˜ ë˜ëŠ” ëª¨ìŠµì„ ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br />

### ì¸í„°í˜ì´ìŠ¤ í”„ë¡œì ì…˜

---

ì¸í„°í˜ì´ìŠ¤ í”„ë¡œì ì…˜ì€ ê°ì²´ ì°¸ì¡°ê´€ê³„ë§ˆì €ë„ í”„ë¡œì ì…˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì‹¬ì§€ì–´ëŠ” `SpEL`ë¡œ ì œê³µë˜ëŠ” `target` ë³€ìˆ˜ë¥¼ ì´ìš©í•´ ë”ìš± ë””í…Œì¼í•œ í”„ë¡œì ì…˜ì´ ê°€ëŠ¥í•˜ì§€ë§Œ, ì´ ê²½ìš° `ì–¸ë”ë°”(_)`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì½”ë”© ì»¨ë²¤ì…˜ì´ ê¹¨ì§€ëŠ” ì•½ê°„ì˜ ë¬¸ì œê°€ ìˆì–´ ì €ëŠ” ì„ í˜¸í•˜ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤.

í•˜ì§€ë§Œ ê¸°ë³¸ì ì¸ ì¸í„°í˜ì´ìŠ¤ í”„ë¡œì ì…˜ìœ¼ë¡œë„ ì¶©ë¶„íˆ ê°•ë ¥í•˜ê¸° ë•Œë¬¸ì— ì•Œì•„ë‘ì‹œë©´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

<br />

ìš°ì„  Itemì„ ì°¸ì¡°í•˜ëŠ” ê°„ë‹¨í•œ CartItem ì—”í‹°í‹°ë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.

ì´ë•Œ ë‹¨ë°©í–¥ `OneToMany`ì— `cascade`ë¥¼ ì‚¬ìš©í•˜ì˜€ëŠ”ë°, ì´ë ‡ê²Œ í•˜ì‹œë©´ ì™¸ë˜í‚¤(FK) ì§€ì •ì„ ìœ„í•´ ë§¤ë²ˆ ì¶”ê°€ì ì¸ update ì¿¼ë¦¬ê°€ ë°œìƒí•˜ë¯€ë¡œ ë¬¸ì œê°€ ìˆëŠ” ì½”ë“œì…ë‹ˆë‹¤.  

ì¦‰, ì´ê²ƒì€ ë‹¨ìˆœíˆ í…ŒìŠ¤íŠ¸ë¥¼ ì¡°ê¸ˆ ë” í¸í•˜ê²Œ í•˜ê³ ìí•¨ì´ë¯€ë¡œ ì‹¤ì œ ì—…ë¬´ì—ì„œ ì‚¬ìš©í•˜ì‹œëŠ” ê²ƒì€ ì¶”ì²œë“œë¦¬ì§€ ì•ŠìŠµë‹ˆë‹¤.

ì´ ê²½ìš°ì—ëŠ” `OneToMany` ì–‘ë°©í–¥ì´ë‚˜ `ManyToMany` ì‚¬ìš©ì„ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤.

<br />

```java
@Entity
@Getter
@ToString
@EntityListeners(AuditingEntityListener.class)
@NoArgsConstructor(access = AccessLevel.PROTECTED)
public class CartItem {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @OneToMany(cascade = CascadeType.ALL)
    private Set<Item> items = new HashSet<>();

    private CartItem(Long id, Set<Item> items) {
        this.id = id;
        this.items = items;
    }

    public static CartItem of(Long id, Set<Item> items) {
        return new CartItem(id, items);
    }

    public void addItem(Item item) {
        items.add(item);
    }

    public boolean isTenBundles() {
        return items.size() == 10;
    }
}
```

<br />

ì´ì œ `CartItem`ì„ í”„ë¡œì ì…˜í•˜ëŠ”ë° ì‚¬ìš©í•  ì¸í„°í˜ì´ìŠ¤ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.

ì´ë•Œ `CartItem`ì´ ì°¸ì¡°í•˜ëŠ” `Set<Item>`ë„ í•¨ê»˜ ê°€ì ¸ì˜¬ ê²ƒì…ë‹ˆë‹¤.

<br />

```java
public interface CartItemProjection {
    Long getId();

    List<ItemDto> getItems();

    interface ItemDto {
        Long getId();

        String getName();

        String getDescription();
    }
}
```

<br />

ê·¸ë¦¬ê³  ë‹¤ìŒê³¼ ê°™ì€ ë¦¬íŒŒì§€í† ë¦¬ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.

ì¿¼ë¦¬ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©° ì¸ìˆ˜ë¡œ ë„˜ê¸´ `id`ë³´ë‹¤ í° `id`ë¥¼ ê°–ëŠ” `CarItem`ë“¤ì„ í”„ë¡œì ì…˜í•©ë‹ˆë‹¤.

<br />

```java
public interface CartItemRepository extends JpaRepository<CartItem, Long> {
    List<CartItemProjection> findByIdAfter(Long id);
}
```

<br />

ë§ˆì§€ë§‰ìœ¼ë¡œ ê²°ê³¼ í™•ì¸ì„ ìœ„í•œ ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.

ì´ 100ê°œì˜ Itemì„ 10ê°œì”© ë¶„í• í•´ ê°ê° 10ê°œì˜ CartItemì— ë„£ê³  ì €ì¥í–ˆìŠµë‹ˆë‹¤.

ì´í›„ idê°€ 5ë³´ë‹¤ í° CartItemë“¤ì„ ì¡°íšŒí•˜ì—¬ DTOë¡œ í”„ë¡œì ì…˜í•©ë‹ˆë‹¤.

<br />

```java
@DataJpaTest
class CartItemRepositoryTest {
    @Autowired
    ItemRepository itemRepository;

    @Autowired
    CartItemRepository cartItemRepository;

    @BeforeEach
    void setUp() {
        CartItem cartItem = null;
        for (int i = 1; i <= 100; i++) {
            if (cartItem == null) {
                cartItem = CartItem.of(null, new HashSet<>());
            }
            if (cartItem.isTenBundles()) {
                cartItemRepository.save(cartItem);
                cartItem = null;
            }
            else {
                cartItem.addItem(createItem(i));
            }
        }
    }

    @Test
    void findByIdAfter_interface() throws Exception {
        cartItemRepository.findByIdAfter(5L).forEach(System.out::println);
    }

    private Item createItem(int itemName) {
        return Item.builder()
                .name("item" + itemName)
                .description("item description")
                .createdAt(LocalDateTime.now())
                .build();
    }
}
```

<br />

```shell
Hibernate: 
    select
        cartitem0_.id as id1_1_ 
    from
        cart_item cartitem0_ 
    where
        cartitem0_.id>?
        
CartItem(id=6, items=[Item(id=51, name=item60, description=item description, createdAt=2022-01-11T19:21:00.009321), Item(id=52, name=item65, description=item description, createdAt=2022-01-11T19:21:00.009321), Item(id=53, name=item63, description=item description, createdAt=2022-01-11T19:21:00.009321), Item(id=54, name=item56, description=item description, createdAt=2022-01-11T19:21:00.009321), Item(id=55, name=item57, description=item description, createdAt=2022-01-11T19:21:00.009321), Item(id=56, name=item58, description=item description, createdAt=2022-01-11T19:21:00.009321), Item(id=57, name=item64, description=item description, createdAt=2022-01-11T19:21:00.009321), Item(id=58, name=item59, description=item description, createdAt=2022-01-11T19:21:00.009321), Item(id=59, name=item62, description=item description, createdAt=2022-01-11T19:21:00.009321), Item(id=60, name=item61, description=item description, createdAt=2022-01-11T19:21:00.009321)])

CartItem(id=7, items=[Item(id=61, name=item67, description=item description, createdAt=2022-01-11T19:21:00.016323600), Item(id=62, name=item76, description=item description, createdAt=2022-01-11T19:21:00.016323600), Item(id=63, name=item71, description=item description, createdAt=2022-01-11T19:21:00.016323600), Item(id=64, name=item74, description=item description, createdAt=2022-01-11T19:21:00.016323600), Item(id=65, name=item75, description=item description, createdAt=2022-01-11T19:21:00.016323600), Item(id=66, name=item69, description=item description, createdAt=2022-01-11T19:21:00.016323600), Item(id=67, name=item68, description=item description, createdAt=2022-01-11T19:21:00.016323600), Item(id=68, name=item73, description=item description, createdAt=2022-01-11T19:21:00.016323600), Item(id=69, name=item72, description=item description, createdAt=2022-01-11T19:21:00.016323600), Item(id=70, name=item70, description=item description, createdAt=2022-01-11T19:21:00.016323600)])

CartItem(id=8, items=[Item(id=71, name=item82, description=item description, createdAt=2022-01-11T19:21:00.026320800), Item(id=72, name=item86, description=item description, createdAt=2022-01-11T19:21:00.026320800), Item(id=73, name=item83, description=item description, createdAt=2022-01-11T19:21:00.026320800), Item(id=74, name=item85, description=item description, createdAt=2022-01-11T19:21:00.026320800), Item(id=75, name=item80, description=item description, createdAt=2022-01-11T19:21:00.026320800), Item(id=76, name=item81, description=item description, createdAt=2022-01-11T19:21:00.026320800), Item(id=77, name=item87, description=item description, createdAt=2022-01-11T19:21:00.026320800), Item(id=78, name=item84, description=item description, createdAt=2022-01-11T19:21:00.026320800), Item(id=79, name=item79, description=item description, createdAt=2022-01-11T19:21:00.026320800), Item(id=80, name=item78, description=item description, createdAt=2022-01-11T19:21:00.026320800)])

CartItem(id=9, items=[Item(id=81, name=item89, description=item description, createdAt=2022-01-11T19:21:00.037323800), Item(id=82, name=item91, description=item description, createdAt=2022-01-11T19:21:00.038323100), Item(id=83, name=item97, description=item description, createdAt=2022-01-11T19:21:00.038323100), Item(id=84, name=item93, description=item description, createdAt=2022-01-11T19:21:00.038323100), Item(id=85, name=item90, description=item description, createdAt=2022-01-11T19:21:00.038323100), Item(id=86, name=item95, description=item description, createdAt=2022-01-11T19:21:00.038323100), Item(id=87, name=item94, description=item description, createdAt=2022-01-11T19:21:00.038323100), Item(id=88, name=item96, description=item description, createdAt=2022-01-11T19:21:00.038323100), Item(id=89, name=item98, description=item description, createdAt=2022-01-11T19:21:00.038323100), Item(id=90, name=item92, description=item description, createdAt=2022-01-11T19:21:00.038323100)])
```

<br />

í° ë¶€ë‹´ ì—†ëŠ” ê¹”ë”í•œ ì¿¼ë¦¬ê°€ ë°œìƒí•˜ì˜€ê³ , í”„ë¡œì ì…˜ì´ ì•„ì£¼ ì˜ ë˜ëŠ”ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br />

### ì œë„¤ë¦­ì„ ì´ìš©í•œ ë™ì  í”„ë¡œì ì…˜(Dynamic Projection)

---

ì´ê²ƒì€ ê·¸ëƒ¥ ë°˜í™˜íƒ€ì…ì„ ì œë„¤ë¦­ìœ¼ë¡œ ì„¤ì •í•´ë²„ë¦¬ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.

ì œë„¤ë¦­ì„ ì‚¬ìš© í•´ ë‹¤ìŒê³¼ ê°™ì€ ì¶”ìƒ ë©”ì„œë“œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.

ë‘ë²ˆì§¸ íŒŒë¼ë¯¸í„°ëŠ” ë°˜í™˜í•  íƒ€ì…ì¸ë°, ì´ê²ƒì€ `java.util.Collection`ì˜ í•˜ìœ„íƒ€ì…ì´ê±°ë‚˜ ì•Œë§ì€ ìƒì„±ìê°€ ìˆëŠ” ë‹¨ì¼ í´ë˜ìŠ¤ì—¬ì•¼ í•©ë‹ˆë‹¤.

ì €ëŠ” ìœ„ì—ì„œ ì‚¬ìš©í•œ `ì¸í„°í˜ì´ìŠ¤ í”„ë¡œì ì…˜`ì˜ ì½”ë“œë¥¼ ê·¸ëŒ€ë¡œ ì¬ì‚¬ìš©í•˜ê² ìŠµë‹ˆë‹¤.

<br />

```java
public interface CartItemRepository extends JpaRepository<CartItem, Long> {
    <T> List<T> findByIdAfter(Long id, Class<T> classType);
}

```

<br />

ì—­ì‹œ ìœ„ì—ì„œ ì‚¬ìš©í•œ í…ŒìŠ¤íŠ¸ì½”ë“œë¥¼ ì¬ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

ì „ì²´ì ì¸ ì½”ë“œëŠ” ì¸í„°í˜ì´ìŠ¤ í”„ë¡œì ì…˜ê³¼ í° ì°¨ì´ê°€ ì—†ìœ¼ë‚˜, ì¿¼ë¦¬ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ë¶€ë¶„ì—ì„œ ë‘ë²ˆì§¸ ì¸ìˆ˜ë¡œ ë°˜í™˜íƒ€ì…ì„ `CartItemProjection.class`ë¡œ ë„˜ê²¨ ì¿¼ë¦¬ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.

<br />

```java
@DataJpaTest
class CartItemRepositoryTest {
    @Autowired
    ItemRepository itemRepository;

    @Autowired
    CartItemRepository cartItemRepository;

    @BeforeEach
    void setUp() {
        CartItem cartItem = null;
        for (int i = 1; i <= 100; i++) {
            if (cartItem == null) {
                cartItem = CartItem.of(null, new HashSet<>());
            }
            if (cartItem.isTenBundles()) {
                cartItemRepository.save(cartItem);
                cartItem = null;
            }
            else {
                cartItem.addItem(createItem(i));
            }
        }
    }

    @Test
    void findByIdAfter_dynamic() throws Exception {
        cartItemRepository.findByIdAfter(5L, CartItemProjection.class)
                .forEach(System.out::println);
    }

    private Item createItem(int itemName) {
        return Item.builder()
                .name("item" + itemName)
                .description("item description")
                .createdAt(LocalDateTime.now())
                .build();
    }
}
```

<br />

```shell
Hibernate: 
    select
        cartitem0_.id as id1_1_ 
    from
        cart_item cartitem0_ 
    where
        cartitem0_.id>?
        
CartItem(id=6, items=[Item(id=51, name=item60, description=item description, createdAt=2022-01-11T19:27:54.715796700), Item(id=52, name=item65, description=item description, createdAt=2022-01-11T19:27:54.715796700), Item(id=53, name=item56, description=item description, createdAt=2022-01-11T19:27:54.715796700), Item(id=54, name=item63, description=item description, createdAt=2022-01-11T19:27:54.715796700), Item(id=55, name=item57, description=item description, createdAt=2022-01-11T19:27:54.715796700), Item(id=56, name=item59, description=item description, createdAt=2022-01-11T19:27:54.715796700), Item(id=57, name=item61, description=item description, createdAt=2022-01-11T19:27:54.715796700), Item(id=58, name=item62, description=item description, createdAt=2022-01-11T19:27:54.715796700), Item(id=59, name=item64, description=item description, createdAt=2022-01-11T19:27:54.715796700), Item(id=60, name=item58, description=item description, createdAt=2022-01-11T19:27:54.715796700)])

CartItem(id=7, items=[Item(id=61, name=item67, description=item description, createdAt=2022-01-11T19:27:54.722796), Item(id=62, name=item72, description=item description, createdAt=2022-01-11T19:27:54.722796), Item(id=63, name=item73, description=item description, createdAt=2022-01-11T19:27:54.722796), Item(id=64, name=item68, description=item description, createdAt=2022-01-11T19:27:54.722796), Item(id=65, name=item71, description=item description, createdAt=2022-01-11T19:27:54.722796), Item(id=66, name=item70, description=item description, createdAt=2022-01-11T19:27:54.722796), Item(id=67, name=item76, description=item description, createdAt=2022-01-11T19:27:54.722796), Item(id=68, name=item74, description=item description, createdAt=2022-01-11T19:27:54.722796), Item(id=69, name=item69, description=item description, createdAt=2022-01-11T19:27:54.722796), Item(id=70, name=item75, description=item description, createdAt=2022-01-11T19:27:54.722796)])

CartItem(id=8, items=[Item(id=71, name=item79, description=item description, createdAt=2022-01-11T19:27:54.729795600), Item(id=72, name=item82, description=item description, createdAt=2022-01-11T19:27:54.729795600), Item(id=73, name=item80, description=item description, createdAt=2022-01-11T19:27:54.729795600), Item(id=74, name=item81, description=item description, createdAt=2022-01-11T19:27:54.729795600), Item(id=75, name=item83, description=item description, createdAt=2022-01-11T19:27:54.729795600), Item(id=76, name=item78, description=item description, createdAt=2022-01-11T19:27:54.729795600), Item(id=77, name=item84, description=item description, createdAt=2022-01-11T19:27:54.729795600), Item(id=78, name=item86, description=item description, createdAt=2022-01-11T19:27:54.729795600), Item(id=79, name=item85, description=item description, createdAt=2022-01-11T19:27:54.729795600), Item(id=80, name=item87, description=item description, createdAt=2022-01-11T19:27:54.729795600)])

CartItem(id=9, items=[Item(id=81, name=item93, description=item description, createdAt=2022-01-11T19:27:54.736794200), Item(id=82, name=item97, description=item description, createdAt=2022-01-11T19:27:54.736794200), Item(id=83, name=item98, description=item description, createdAt=2022-01-11T19:27:54.736794200), Item(id=84, name=item89, description=item description, createdAt=2022-01-11T19:27:54.736794200), Item(id=85, name=item90, description=item description, createdAt=2022-01-11T19:27:54.736794200), Item(id=86, name=item96, description=item description, createdAt=2022-01-11T19:27:54.736794200), Item(id=87, name=item91, description=item description, createdAt=2022-01-11T19:27:54.736794200), Item(id=88, name=item94, description=item description, createdAt=2022-01-11T19:27:54.736794200), Item(id=89, name=item92, description=item description, createdAt=2022-01-11T19:27:54.736794200), Item(id=90, name=item95, description=item description, createdAt=2022-01-11T19:27:54.736794200)])
```

<br />

ì—­ì‹œ ì•„ì£¼ ê¹”ë”í•˜ê²Œ ì˜ ë˜ëŠ” ëª¨ìŠµì„ ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br />

## ğŸ’¡ Query By Example API

---

ì¿¼ë¦¬ ë©”ì„œë“œëŠ” ë§¤ìš° ê°•ë ¥í•˜ì§€ë§Œ ì¹˜ëª…ì ì¸ ë‹¨ì ì´ í•˜ë‚˜ ìˆìŠµë‹ˆë‹¤.

ë°”ë¡œ ì¡°ê±´ì´ ì¡°ê¸ˆë§Œ ë³µì¡í•´ì§€ë©´ ë©”ì„œë“œì´ë¦„ì˜ ê¸¸ì´ê°€ ì‚¬ìš©í• ìˆ˜ ì—†ì„ì •ë„ë¡œ ê¸¸ì–´ì§„ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.

idê°€ ì¼ì¹˜í•˜ë©´ì„œ, nameì„ í¬í•¨í•˜ê³ (like ê²€ìƒ‰), descriptionë„ í¬í•¨í•˜ëŠ”(like ê²€ìƒ‰) ì¡°ê±´ì„ ì¿¼ë¦¬ ë©”ì„œë“œë¡œ ì‘ì„±í•˜ë©´ í•˜ê¸°ì™€ ê°™ìŠµë‹ˆë‹¤.

ë„ˆë¬´ ê¸¸ì£ ?

<br />

```java
public interface ItemRepository extends JpaRepository<Item, Long> {
    List<Item> findByIdAndNameContainingAndDescriptionContaining(Long id, String name, String description);
}

@DataJpaTest
class ItemRepositoryTest {
  @Test
  void queryMethodLimit() throws Exception {
    itemRepository.findByIdAndNameContainingAndDescriptionContaining(1L, "item", "desc") // ë„ˆë¬´ ì¥í™©í•˜ë‹¤... ğŸ¤”
            .forEach(System.out::println);
  }
}
```

<br />

```shell
Hibernate: 
    select
        item0_.id as id1_4_,
        item0_.created_at as created_2_4_,
        item0_.description as descript3_4_,
        item0_.name as name4_4_ 
    from
        item item0_ 
    where
        item0_.id=? 
        and (
            item0_.name like ? escape ?
        ) 
        and (
            item0_.description like ? escape ?
        )
```

<br />

ì´ëŸ¬í•œ ë¬¸ì œë¥¼ ë³´ì™„í•˜ëŠ”ê²Œ `Example API`ì…ë‹ˆë‹¤.

<br />

`Example API`ëŠ” í¬ê²Œ ì„¸ ë¶€ë¶„ìœ¼ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤.

<br />

- Probe: ê²€ìƒ‰ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•œ ì¡°ê±´ì„ ë‹´ì€ ì‹¤ì œ ì—”í‹°í‹° ê°œì²´
- ExampleMatcher: ì„¸ë¶€ì ì¸ ê²€ìƒ‰ì„ ì„¤ì •í•˜ëŠ” ê°œì²´
- Example<T>: Probeì™€ ExampleMatcherë¡œ ì´ë£¨ì–´ì§„ ìµœì¢… ê°œì²´

<br />

ë§ë¡œë§Œ ë– ë“¤ë©´ ì´í•´í•˜ê¸° í˜ë“¤ ìˆ˜ ìˆìœ¼ë‹ˆ ì¥í™©í•œ `findByIdAndNameContainingAndDescriptionContaining`ë¥¼ `Example API`ë¥¼ ì‚¬ìš©í•´ ë¦¬íŒ©í† ë§ í•´ë³´ê² ìŠµë‹ˆë‹¤.

<br />

ìš°ì„  `QueryByExampleExecutor<T>` ì¸í„°í˜ì´ìŠ¤ë¥¼ ì¶”ê°€ë¡œ ìƒì†í•´ì•¼ í•©ë‹ˆë‹¤.

ì—¬ê¸°ì„œ TëŠ” ê²€ìƒ‰ì„ ì‹¤í–‰í•  ì£¼ì²´ê°€ë˜ëŠ” ì—”í‹°í‹°ì…ë‹ˆë‹¤.

<br />

```java
public interface ItemRepository extends JpaRepository<Item, Long>, QueryByExampleExecutor<Item> {
}
```

<br />

```java
@DataJpaTest
class ItemRepositoryTest {
    @Autowired
    ItemRepository itemRepository;

    @Test
    void queryMethodRefactor() throws Exception {
        Item probe = Item.of(1L, "item", "desc", null);
        
        ExampleMatcher matcher = ExampleMatcher.matching()
                .withIgnorePaths("createdAt")
                .withStringMatcher(ExampleMatcher.StringMatcher.CONTAINING);

        Example<Item> example = Example.of(probe, matcher);
        
        itemRepository.findAll(example).forEach(System.out::println);
    }
}
```

<br />

```shell
Hibernate: 
    select
        item0_.id as id1_4_,
        item0_.created_at as created_2_4_,
        item0_.description as descript3_4_,
        item0_.name as name4_4_ 
    from
        item item0_ 
    where
        item0_.id=? 
        and (
            item0_.name like ? escape ?
        ) 
        and (
            item0_.description like ? escape ?
        )
```

<br />

ì •í™•íˆ ë™ì¼í•œ ì¿¼ë¦¬ê°€ ë°œìƒí•©ë‹ˆë‹¤.

ì´ê²Œ ê°€ëŠ¥í•œ ì´ìœ ëŠ” `QueryByExampleExecutor<T>` ì¸í„°í˜ì´ìŠ¤ì˜ ì¶”ìƒ ë©”ì„œë“œ ì‹œê·¸ë‹ˆì²˜ë¥¼ í™•ì¸í•´ë³´ë©´ ì‰½ê²Œ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br />

```java
public interface QueryByExampleExecutor<T> {

	<S extends T> Optional<S> findOne(Example<S> example);

	<S extends T> Iterable<S> findAll(Example<S> example);

	<S extends T> Iterable<S> findAll(Example<S> example, Sort sort);

	<S extends T> Page<S> findAll(Example<S> example, Pageable pageable);

	<S extends T> long count(Example<S> example);

	<S extends T> boolean exists(Example<S> example);
}
```

<br />

`Example` íƒ€ì…ì„ ì¸ìë¡œ ë°›ì•„ ê²€ìƒ‰ì„ ìˆ˜í–‰í•˜ê³  ì´ì— ëŒ€í•œ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ê³  ìˆìŒì„ í™•ì¸í•  ìˆ˜ ìˆì£ .

<br />

ì–´ë–»ê²Œ ë³´ë©´ ì¿¼ë¦¬ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ëŠ”ê²ƒ ì´ìƒìœ¼ë¡œ ì½”ë“œë¥¼ ë§ì´ ì‘ì„±í•˜ê¸´ í•©ë‹ˆë‹¤ë§Œ, ê²€ìƒ‰ ì¡°ê±´ì´ ë³µì¡í•˜ê³  ìœ ë™ì ìœ¼ë¡œ ë³€ê²½ë˜ì–´ì•¼ í•˜ëŠ” ìƒí™©ì´ë¼ë©´ ë¶„ëª…íˆ ì‚¬ìš©í•´ë³¼ ê°€ì¹˜ê°€ ìˆìŠµë‹ˆë‹¤.

ìš°ì„ , ê²€ìƒ‰ ì¡°ê±´ì„ ë§¤ìš° ë””í…Œì¼í•˜ê²Œ ì„¤ì •í•  ìˆ˜ ìˆìœ¼ë©°, ë©”ì„œë“œëª…ì´ ì•„ë‹Œ ë©”ì„œë“œ ìì²´ë¡œ ì‘ì„±ë˜ê¸° ë•Œë¬¸ì— ë³„ë„ì˜ ë¦¬íŒŒì§€í† ë¦¬ì— ìº¡ìŠí™”í•˜ì—¬ ê´€ë¦¬í•˜ê¸°ë„ ìš©ì´í•©ë‹ˆë‹¤.

ê²€ìƒ‰ì¡°ê±´ì´ ë³€ê²½ëœë‹¤ë©´ `ExampleMatcher`ë§Œ ì†ë´ì£¼ë©´ ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

<br />

ì•„ë˜ëŠ” ê³µì‹ ë¬¸ì„œì—ì„œ ì†Œê°œí•˜ëŠ” `Example API`ì˜ ì¥ë‹¨ì ì…ë‹ˆë‹¤.

<br />

- `Query by Example`ì€ ë‹¤ìŒ ì‚¬ë¡€ì— ì í•©í•©ë‹ˆë‹¤.
  - ì¼ë ¨ì˜ ì •ì  ë˜ëŠ” ë™ì  ì œì•½ ì¡°ê±´ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„° ì €ì¥ì†Œë¥¼ ì¿¼ë¦¬í•©ë‹ˆë‹¤. 
  - ê¸°ì¡´ ì¿¼ë¦¬ ì¤‘ë‹¨ì— ëŒ€í•œ ê±±ì • ì—†ì´ ë„ë©”ì¸ ê°ì²´ë¥¼ ìì£¼ ë¦¬íŒ©í† ë§í•©ë‹ˆë‹¤. 
  - ê¸°ë³¸ ë°ì´í„° ì €ì¥ì†Œ APIì™€ ë…ë¦½ì ìœ¼ë¡œ ì‘ì—…í•©ë‹ˆë‹¤.

- `Query by Example`ì—ë„ ëª‡ ê°€ì§€ ì œì•½ ì‚¬í•­ì´ ìˆìŠµë‹ˆë‹¤.
  - ë‹¤ìŒê³¼ ê°™ì´ ì¤‘ì²©ë˜ê±°ë‚˜ ê·¸ë£¹í™”ëœ ì†ì„± ì œì•½ ì¡°ê±´ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. `firstname = ?0 or (firstname = ?1 and lastname = ?2).` 
  - ë¬¸ìì—´ì— ëŒ€í•œ starts(ì‹œì‘ë¶€ ì¼ì¹˜)/contains(ë¬¸ìì—´ í¬í•¨)/ends(ëë¶€ë¶„ë§Œ ì¼ì¹˜)/regex(ì •ê·œì‹) ì¼ì¹˜ ë° ê¸°íƒ€ ì†ì„± ìœ í˜•ì— ëŒ€í•œ ì •í™•í•œ ì¼ì¹˜ë§Œ ì§€ì›í•©ë‹ˆë‹¤.

<br />

ë” ìƒì„¸í•œ ì‚¬ìš©ë²•ì— ëŒ€í•œ ë‚´ìš©ì€ [ğŸ“œ Spring Data JPA Docs - Query by Example](https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#query-by-example){:target="_blank"} ì— ê¸°ìˆ ë˜ì–´ ìˆìœ¼ë‹ˆ ê´€ì‹¬ì´ ìˆìœ¼ì‹œë‹¤ë©´ í•œë²ˆ ì‚´í´ë³´ì‹œëŠ”ê²ƒë„ ì¢‹ê² ìŠµë‹ˆë‹¤.

ë˜í•œ, `ì¿¼ë¦¬ ë©”ì„œë“œ`ì™€ `Example API`ë¡œë„ í•´ê²°ì´ ì•ˆëœë‹¤ë©´ ì§„ì§€í•˜ê²Œ `Querydsl` ì‚¬ìš©ì„ ê³ ë ¤í•´ë´ì•¼ í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤.

<br />
